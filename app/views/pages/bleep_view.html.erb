<div class="container mx-auto px-4 py-8">
  <div class="max-w-2xl mx-auto">
    <!-- Purpose Banner -->
    <div class="mb-6 p-4 bg-indigo-100 border-l-4 border-indigo-500 rounded shadow">
      <div class="flex items-center">
        <span class="text-2xl mr-3">üîä</span>
        <div>
          <h1 class="text-2xl font-bold mb-1">Bleep Your Sh*t!</h1>
          <p class="text-indigo-800">
            Process your <strong>entire audio or video file</strong>, censoring selected words with customizable matching and bleep sounds.
          </p>
        </div>
      </div>
    </div>

    <!-- Workflow Guidance -->
    <div class="mb-2 text-sm font-semibold text-gray-700 uppercase tracking-wide">How it works</div>
    <ol class="mb-6 pl-6 list-decimal text-gray-700">
      <li><span class="mr-1">üéµ</span><strong>Upload your file</strong> (audio or video).</li>
      <li><span class="mr-1">üó£Ô∏è</span><strong>Select language and model</strong> for transcription.</li>
      <li><span class="mr-1">üîä</span><strong>Transcribe</strong> your file to generate a word-level transcript.</li>
      <li><span class="mr-1">üß©</span><strong>Enter words and matching modes</strong> (exact, partial, fuzzy).</li>
      <li><span class="mr-1">üîç</span><strong>Run matching</strong> to find words to censor.</li>
      <li><span class="mr-1">üîî</span><strong>Choose bleep sound</strong> for censorship.</li>
      <li><span class="mr-1">üëÄ</span><strong>Bleep audio and preview/download the censored result.</strong></li>
    </ol>

    <!-- Link to Sampler -->
    <div class="mb-6 p-3 bg-blue-50 border border-blue-300 rounded flex items-center">
      <span class="mr-2">üí°</span>
      <span>
        Not sure which model to use? 
        <a href="/transcription-sampler-view" class="text-blue-700 underline font-semibold hover:text-blue-900">Try the Transcription Sampler</a>
        to compare models on a short snippet first.
      </span>
    </div>

    <!-- Step 1: Upload File -->
    <section class="step mb-8 p-6 border-l-4 border-blue-400 bg-blue-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-blue-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">1</span>
        <h2 class="text-lg font-semibold">Upload Your File</h2>
      </div>
      <p class="mb-2 text-sm text-blue-900">Audio (MP3) or Video (MP4) supported. Preview your input before processing.</p>
      <div id="bleep-dropzone" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500 transition-colors">
        <p class="text-gray-600">Drag and drop your audio or video file here or click to browse</p>
        <input type="file" id="bleepFileInput" accept="audio/*,video/*" class="hidden">
      </div>
      <div id="bleepFileWarning" class="mt-2"></div>
      <details id="bleepInputPreviewSection" class="mt-6 hidden">
        <summary class="cursor-pointer text-lg font-semibold text-gray-700 select-none">Preview Input File (Audio/Video)</summary>
        <div id="bleepInputPreviewContainer" class="mt-4">
          <!-- Player will be injected here by JS -->
        </div>
      </details>
    </section>

    <!-- Step 2: Select Language & Model -->
    <section class="step mb-8 p-6 border-l-4 border-green-400 bg-green-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-green-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">2</span>
        <h2 class="text-lg font-semibold">Select Language & Model</h2>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="bleepLanguage" class="block text-sm font-medium text-gray-700 mb-2">Language</label>
          <select id="bleepLanguage" class="w-full p-2 border border-gray-300 rounded-md">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="nl">Dutch</option>
            <option value="pl">Polish</option>
            <option value="ru">Russian</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="zh">Chinese</option>
          </select>
        </div>
        <div>
          <label for="bleepModel" class="block text-sm font-medium text-gray-700 mb-2">Model</label>
          <select id="bleepModel" class="w-full p-2 border border-gray-300 rounded-md">
            <option value="onnx-community/whisper-tiny_timestamped">Tiny (Smallest, fastest, least accurate)</option>
            <option value="onnx-community/whisper-base_timestamped">Base (Faster, less accurate)</option>
            <option value="onnx-community/whisper-small_timestamped" selected>Small (Balanced)</option>
            <option value="onnx-community/whisper-large-v3-turbo_timestamped">Large (Slowest, most accurate)</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Step 3: Transcribe -->
    <section class="step mb-8 p-6 border-l-4 border-indigo-400 bg-indigo-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-indigo-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">3</span>
        <h2 class="text-lg font-semibold">Transcribe</h2>
      </div>
      <button id="transcribeAndBleepButton" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700">Transcribe</button>
      <button id="cancelTranscriptionButton" class="w-full bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 mt-2 hidden">Cancel</button>
      <div class="mt-6" id="bleepProgressContainer">
        <div class="w-full bg-gray-200 rounded-full h-2.5">
          <div id="bleepProgressBar" class="bg-indigo-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
        </div>
        <div id="bleepProgressText" class="text-center text-sm text-gray-600 mt-2">0%</div>
      </div>
      <details id="bleepTranscriptSection" class="mt-6 hidden">
        <summary class="cursor-pointer text-lg font-semibold text-gray-700 select-none">View Transcript & Word Timestamps</summary>
        <div id="bleepTranscriptContainer" class="mt-4"></div>
      </details>
    </section>

    <!-- Step 4: Enter Words & Matching Modes -->
    <section class="step mb-8 p-6 border-l-4 border-purple-400 bg-purple-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-purple-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">4</span>
        <h2 class="text-lg font-semibold">Enter Words & Matching Modes</h2>
      </div>
      <label for="bleepWords" class="block text-sm font-medium text-gray-700 mb-2">Words to Censor (comma or space separated)</label>
      <input type="text" id="bleepWords" class="w-full p-2 border border-gray-300 rounded-md" placeholder="e.g. damn, hell, shoot">
      <div class="mt-4">
        <span class="block text-sm font-medium text-gray-700 mb-2">Matching Modes</span>
        <div class="mb-2 text-xs text-gray-600">
          <strong>Exact:</strong> Only censors words that match exactly (e.g. "damn" matches only "damn").<br>
          <strong>Partial:</strong> Censors words that contain the target as part of a larger word (e.g. "damn" matches "damnation").<br>
          <strong>Fuzzy:</strong> Censors words that are similar to the target, allowing for typos or close spellings (e.g. "damn" matches "dam" or "damm").
        </div>
        <label class="inline-flex items-center mr-4">
          <input type="checkbox" id="matchExact" checked class="form-checkbox">
          <span class="ml-2">Exact</span>
        </label>
        <label class="inline-flex items-center mr-4">
          <input type="checkbox" id="matchPartial" class="form-checkbox">
          <span class="ml-2">Partial</span>
        </label>
        <label class="inline-flex items-center">
          <input type="checkbox" id="matchFuzzy" class="form-checkbox">
          <span class="ml-2">Fuzzy</span>
        </label>
      </div>
      <div id="fuzzyDistanceContainer" class="mt-2 hidden">
        <label for="fuzzyDistance" class="block text-xs text-gray-600">Fuzzy Distance (max edits)</label>
        <input type="number" id="fuzzyDistance" min="1" max="5" value="1" class="w-20 p-1 border border-gray-300 rounded-md text-sm">
      </div>
    </section>

    <!-- Step 5: Run Matching -->
    <section class="step mb-8 p-6 border-l-4 border-pink-400 bg-pink-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-pink-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">5</span>
        <h2 class="text-lg font-semibold">Run Matching</h2>
      </div>
      <button id="runMatchingButton" class="w-full bg-pink-600 text-white py-2 px-4 rounded-md hover:bg-pink-700">Run Matching</button>
      <div class="mt-4" id="bleepMatchResults"></div>
    </section>

    <!-- Step 6: Choose Bleep Sound -->
    <section class="step mb-8 p-6 border-l-4 border-yellow-400 bg-yellow-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-yellow-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">6</span>
        <h2 class="text-lg font-semibold">Choose Bleep Sound</h2>
      </div>
      <label for="bleepSound" class="block text-sm font-medium text-gray-700 mb-2">Bleep Sound</label>
      <select id="bleepSound" class="w-full p-2 border border-gray-300 rounded-md">
        <option value="">Select a bleep sound...</option>
      </select>
      <button id="bleepPreviewButton" type="button" class="mt-2 px-4 py-1 bg-gray-200 rounded hover:bg-gray-300">Preview</button>
      <span id="bleepSoundName" class="ml-2 text-sm text-gray-600"></span>
    </section>

    <!-- Step 7: Bleep Audio! -->
    <section class="step mb-8 p-6 border-l-4 border-violet-400 bg-violet-50 rounded">
      <div class="flex items-center mb-2">
        <span class="step-number bg-violet-400 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 font-bold">7</span>
        <h2 class="text-lg font-semibold">Bleep Audio!</h2>
      </div>
      <button id="bleepAudioButton" class="w-full bg-violet-600 text-white py-2 px-4 rounded-md hover:bg-violet-700" disabled>Bleep Audio!</button>
      <!-- Censored Video Player -->
      <div class="mt-4 hidden" id="censoredVideoPlayerContainer"></div>
      <button id="downloadCensoredVideoButton" class="hidden bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mt-2">Download Censored Video</button>
      <!-- Censored Audio Player -->
      <div class="mt-4 hidden" id="censoredAudioPlayerContainer"></div>
      <!-- Results Placeholder -->
      <div class="mt-6" id="bleepResultsContainer">
        <!-- Processed audio player and download link will be inserted here -->
      </div>
    </section>
  </div>
</div> 